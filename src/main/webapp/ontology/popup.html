<html>

<head>
    <title>Popup</title>
</head>

<body>
    <div id="pickerMap" style="width: 800px; height: 600px"></div><button onclick="savePosition()">Salva</button>
    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
    <script>var pickerMap = L.map("pickerMap").setView([17.385044, 78.486671], 10); var pickerLayer = new L.TileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"); pickerMap.addLayer(pickerLayer); var marker = L.marker([17.385044, 78.486671], { draggable: true }).addTo(pickerMap); marker.on("dragend", function (e) { console.log("Marker dragged to", e.target.getLatLng()); }); function savePosition() { var position = marker.getLatLng(); window.opener.postMessage({ latitude: position.lat, longitude: position.lng }, "*"); window.close(); }</script>
</body>

</html>